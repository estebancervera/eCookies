<%- include("../partials/header") %>

<link rel="stylesheet" href="/orders.css">


<%- include("../partials/navbarBusiness") %>

<% var options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' , hour: 'numeric', minute: 'numeric' }; %>


<div class="container border border-dark rounded-lg">
    <table data-toggle="table">
        <thead>
          <tr>
            
            <th>Fecha de la Orden</th>
            <th>Numero de Productos</th>
            <th>Numero de Paquetes</th>
            <th>Fecha de Entrega</th>
            <th>Ver Detalles</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
        <% orders.forEach(function(order){ %>
          <% const deliveryDate = new Date(order.deliveryDate) %>
           <% const orderDate = new Date(order.orderDate) %>
          <%  const oY = new Intl.DateTimeFormat('es-ES', { year: 'numeric' }).format(orderDate) %>
          <%  const oM = new Intl.DateTimeFormat('es-ES', { month: 'long' }).format(orderDate) %>
          <%  const oD = new Intl.DateTimeFormat('es-ES', { day: '2-digit' }).format(orderDate)  %>
          <%  const oH = new Intl.DateTimeFormat('es-ES', { hour: 'numeric' }).format(orderDate)  %>
          <%  const oMi = new Intl.DateTimeFormat('es-ES', { minute: 'numeric' }).format(orderDate)  %>


                <% var numCookies = 0; %>
                   <%  order.packets.forEach((packet) => { numCookies += packet.quantity;}) %>
          
          <tr>
            
            <td><%= `${oD} - ${oM} - ${oY}, a las ${oH}:${oMi}` %></td>
            <td><%= numCookies %></td>
            <td><%= order.packets.length %></td>
            <td><%= order.deliveryDate.toLocaleDateString('es-ES', options) %></td>
            <td><a href="/business/orders/<%= order._id %>/show">MOSTRAR</a></td>
            <td><%= order.status %></td>
          </tr>
        
          <% });  %>
          
        </tbody>
      </table>
</div>
<%- include("../partials/framejs") %>


<%- include("../partials/footer") %>